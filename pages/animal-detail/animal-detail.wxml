<!--pages/animal-detail/animal-detail.wxml-->
<view class="container" wx:if="{{!loading}}">
  <!-- åŠ¨ç‰©ç…§ç‰‡ -->
  <view class="photo-section" wx:if="{{animal.photos && animal.photos.length > 0}}">
    <image 
      class="animal-photo" 
      src="{{animal.photos[0]}}" 
      mode="aspectFill"
      bindtap="previewImage"
    />
    <view class="photo-count" wx:if="{{animal.photos.length > 1}}">
      +{{animal.photos.length - 1}}
    </view>
  </view>

  <!-- åŸºæœ¬ä¿¡æ¯ -->
  <view class="section">
    <view class="section-title">ğŸ¾ åŸºæœ¬ä¿¡æ¯</view>
    <view class="info-grid">
      <view class="info-item">
        <text class="info-label">ç¼–å·</text>
        <text class="info-value">{{animal.id}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">åç§°</text>
        <text class="info-value">{{animal.name}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">ç§ç±»</text>
        <text class="info-value">{{animal.type}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">å“ç§</text>
        <text class="info-value">{{animal.breed}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">æ€§åˆ«</text>
        <text class="info-value">{{animal.gender}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">å¹´é¾„</text>
        <text class="info-value">{{animal.ageEstimate}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">ä½“é‡</text>
        <text class="info-value">{{animal.weight}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">æ¯›è‰²</text>
        <text class="info-value">{{animal.furColor}}</text>
      </view>
    </view>
    
    <view class="feature-item" wx:if="{{animal.distinguishingFeatures}}">
      <text class="info-label">ç‰¹å¾æ ‡è¯†</text>
      <text class="info-value feature-text">{{animal.distinguishingFeatures}}</text>
    </view>
  </view>

  <!-- å¥åº·çŠ¶å†µ -->
  <view class="section">
    <view class="section-title">ğŸ¥ å¥åº·çŠ¶å†µ</view>
    <view class="health-grid">
      <view class="health-item">
        <text class="health-label">å¥åº·çŠ¶æ€</text>
        <view class="health-status status-{{animal.healthStatus}}">{{animal.healthStatus}}</view>
      </view>
      <view class="health-item">
        <text class="health-label">æ˜¯å¦ç»è‚²</text>
        <text class="health-value">{{animal.isNeutered}}</text>
      </view>
      <view class="health-item">
        <text class="health-label">ç–«è‹—æƒ…å†µ</text>
        <text class="health-value">{{animal.isVaccinated}}</text>
      </view>
    </view>
    
    <view class="medical-records" wx:if="{{animal.medicalRecords && animal.medicalRecords.length > 0}}">
      <text class="records-title">ä½“æ£€è®°å½•ï¼š</text>
      <view class="record-item" wx:for="{{animal.medicalRecords}}" wx:key="index">
        <text class="record-text">â€¢ {{item}}</text>
      </view>
    </view>
    
    <view class="medical-history" wx:if="{{animal.medicalHistory}}">
      <text class="records-title">ç—…å²è®°å½•ï¼š</text>
      <text class="history-text">{{animal.medicalHistory}}</text>
    </view>
  </view>

  <!-- æ•‘åŠ©æƒ…å†µ -->
  <view class="section">
    <view class="section-title">ğŸ†˜ æ•‘åŠ©æƒ…å†µ</view>
    <view class="rescue-info">
      <view class="rescue-item">
        <text class="rescue-label">æ•‘åŠ©æ—¥æœŸ</text>
        <text class="rescue-value">{{animal.rescueDate}}</text>
      </view>
      <view class="rescue-item">
        <text class="rescue-label">æ•‘åŠ©åœ°ç‚¹</text>
        <text class="rescue-value">{{animal.rescueLocation}}</text>
      </view>
      <view class="rescue-item">
        <text class="rescue-label">æ•‘åŠ©äºº</text>
        <text class="rescue-value">{{animal.rescuer}}</text>
      </view>
    </view>
    
    <view class="rescue-reason" wx:if="{{animal.rescueReason}}">
      <text class="records-title">æ•‘åŠ©åŸå› ï¼š</text>
      <text class="reason-text">{{animal.rescueReason}}</text>
    </view>
  </view>

  <!-- æ€§æ ¼ä¸ä¹ æ€§ -->
  <view class="section">
    <view class="section-title">ğŸ˜º æ€§æ ¼ä¸ä¹ æ€§</view>
    <view class="personality-info">
      <view class="personality-item" wx:if="{{animal.personality}}">
        <text class="personality-label">æ€§æ ¼æè¿°</text>
        <text class="personality-value">{{animal.personality}}</text>
      </view>
      <view class="personality-item" wx:if="{{animal.suitableEnvironment}}">
        <text class="personality-label">é€‚åº”ç¯å¢ƒ</text>
        <text class="personality-value">{{animal.suitableEnvironment}}</text>
      </view>
      <view class="personality-item" wx:if="{{animal.habits}}">
        <text class="personality-label">ç”Ÿæ´»ä¹ æƒ¯</text>
        <text class="personality-value">{{animal.habits}}</text>
      </view>
    </view>
  </view>

  <!-- é¢†å…»æƒ…å†µ -->
  <view class="section">
    <view class="section-title">ğŸ  é¢†å…»æƒ…å†µ</view>
    <view class="adoption-info">
      <view class="adoption-item">
        <text class="adoption-label">æ˜¯å¦å¯é¢†å…»</text>
        <view class="adoption-status status-{{animal.isAdoptable}}">{{animal.isAdoptable}}</view>
      </view>
      <view class="adoption-item">
        <text class="adoption-label">å½“å‰çŠ¶æ€</text>
        <view class="current-status status-{{animal.currentStatus}}">{{animal.currentStatus}}</view>
      </view>
    </view>
    
    <view class="adoption-requirements" wx:if="{{animal.adoptionRequirements}}">
      <text class="records-title">é¢†å…»é¡»çŸ¥ï¼š</text>
      <text class="requirements-text">{{animal.adoptionRequirements}}</text>
    </view>
    
    <!-- å·²é¢†å…»ä¿¡æ¯ -->
    <view class="adopted-info" wx:if="{{animal.currentStatus === 'å·²è¢«é¢†å…»' && animal.adoptedPersonName}}">
      <text class="records-title">é¢†å…»äººä¿¡æ¯ï¼š</text>
      <view class="adopted-details">
        <text class="adopted-item">å§“åï¼š{{animal.adoptedPersonName}}</text>
        <text class="adopted-item">åŸå¸‚ï¼š{{animal.adoptedPersonCity}}</text>
        <text class="adopted-item">è”ç³»æ–¹å¼ï¼š{{animal.adoptedPersonContact}}</text>
      </view>
    </view>
  </view>

  <!-- å¤‡æ³¨ -->
  <view class="section" wx:if="{{animal.remarks}}">
    <view class="section-title">ğŸ“ å¤‡æ³¨</view>
    <text class="remarks-text">{{animal.remarks}}</text>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons" wx:if="{{animal}}">
    <!-- æˆ‘çš„æ¡£æ¡ˆæ‰æ˜¾ç¤ºç¼–è¾‘åˆ é™¤æŒ‰é’® -->
    <view wx:if="{{animal.isMyProfile}}" class="my-actions">
      <button class="action-btn edit-btn" bindtap="editProfile">ç¼–è¾‘æ¡£æ¡ˆ</button>
      <button class="action-btn delete-btn" bindtap="confirmDelete">åˆ é™¤æ¡£æ¡ˆ</button>
    </view>
    
    <!-- ç³»ç»Ÿæ¡£æ¡ˆæ˜¾ç¤ºå…¶ä»–æ“ä½œ -->
    <view wx:else class="system-actions">
      <button class="action-btn contact-btn" bindtap="contactRescuer">è”ç³»æ•‘åŠ©äºº</button>
      <button class="action-btn adopt-btn" bindtap="applyAdoption" wx:if="{{animal.isAdoptable === 'æ˜¯'}}">
        ç”³è¯·é¢†å…»
      </button>
    </view>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-container" wx:if="{{loading}}">
  <view class="loading-spinner"></view>
  <text class="loading-text">åŠ è½½ä¸­...</text>
</view>

<!-- åˆ é™¤ç¡®è®¤æ¨¡æ€æ¡† -->
<view class="modal-overlay" wx:if="{{showDeleteModal}}">
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">ç¡®è®¤åˆ é™¤</text>
    </view>
    <view class="modal-body">
      <text class="modal-text">ç¡®å®šè¦åˆ é™¤æ¡£æ¡ˆ"{{animal.name}}"å—ï¼Ÿ</text>
      <text class="modal-warning">æ­¤æ“ä½œä¸å¯æ¢å¤</text>
    </view>
    <view class="modal-actions">
      <button class="modal-btn cancel-btn" bindtap="cancelDelete">å–æ¶ˆ</button>
      <button class="modal-btn confirm-btn" bindtap="deleteProfile">ç¡®è®¤åˆ é™¤</button>
    </view>
  </view>
</view>